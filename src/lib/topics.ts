export const TOPICS_BY_SUBJECT: Record<string, string[]> = {
  // ЕГЭ предметы
  'ru': [
    'Орфография: корни с чередованием', 'Причастие и деепричастие',
    'Сложноподчинённые предложения', 'Пунктуация при однородных членах',
    'Тире и двоеточие в предложении', 'Паронимы и омонимы',
    'Написание НЕ с разными частями речи', 'Текст и его структура',
    'Анализ художественного текста', 'Сочинение: аргументация',
    'Лексические нормы', 'Синтаксические нормы',
  ],
  'Русский язык': [
    'Орфография: корни с чередованием', 'Причастие и деепричастие',
    'Сложноподчинённые предложения', 'Пунктуация при однородных членах',
    'Тире и двоеточие в предложении', 'Паронимы и омонимы',
    'Написание НЕ с разными частями речи', 'Текст и его структура',
    'Анализ художественного текста', 'Сочинение: аргументация',
    'Лексические нормы', 'Синтаксические нормы',
  ],
  'math_prof': [
    'Квадратные уравнения', 'Производная функции', 'Интегралы',
    'Логарифмы', 'Тригонометрия', 'Пределы',
    'Показательные уравнения', 'Иррациональные уравнения',
    'Геометрия: планиметрия', 'Геометрия: стереометрия',
    'Вероятность и статистика', 'Задачи с параметром',
  ],
  'Математика (профиль)': [
    'Квадратные уравнения', 'Производная функции', 'Интегралы',
    'Логарифмы', 'Тригонометрия', 'Пределы',
    'Показательные уравнения', 'Иррациональные уравнения',
    'Геометрия: планиметрия', 'Геометрия: стереометрия',
    'Вероятность и статистика', 'Задачи с параметром',
  ],
  'math_base': [
    'Квадратные уравнения', 'Дроби и проценты',
    'Линейные функции', 'Геометрия: площади',
    'Статистика и вероятность', 'Практические задачи: финансы',
    'Алгебраические выражения', 'Числовые последовательности',
  ],
  'Математика (база)': [
    'Квадратные уравнения', 'Дроби и проценты',
    'Линейные функции', 'Геометрия: площади',
    'Статистика и вероятность', 'Практические задачи: финансы',
    'Алгебраические выражения', 'Числовые последовательности',
  ],
  'math': [
    'Квадратные уравнения', 'Производная функции',
    'Логарифмы', 'Тригонометрия',
    'Алгебра: числовые выражения', 'Геометрия: треугольники',
    'Реальная математика', 'Вероятность',
  ],
  'Математика': [
    'Квадратные уравнения', 'Производная функции',
    'Логарифмы', 'Тригонометрия',
    'Алгебра: числовые выражения', 'Геометрия: треугольники',
    'Реальная математика', 'Вероятность',
  ],
  'physics': [
    'Законы Ньютона', 'Электрическое поле',
    'Магнетизм', 'Оптика', 'Термодинамика',
    'Механика: кинематика', 'Квантовая физика',
    'Ядерные реакции', 'Колебания и волны',
    'Постоянный электрический ток',
  ],
  'Физика': [
    'Законы Ньютона', 'Электрическое поле',
    'Магнетизм', 'Оптика', 'Термодинамика',
    'Механика: кинематика', 'Квантовая физика',
    'Ядерные реакции', 'Колебания и волны',
    'Постоянный электрический ток',
  ],
  'chemistry': [
    'Реакции окисления-восстановления', 'Органические соединения',
    'Периодическая система', 'Кислоты и основания',
    'Строение атома', 'Химическая связь',
    'Реакции в растворах', 'Углеводороды',
    'Кислородсодержащие органические вещества', 'Азотсодержащие соединения',
  ],
  'Химия': [
    'Реакции окисления-восстановления', 'Органические соединения',
    'Периодическая система', 'Кислоты и основания',
    'Строение атома', 'Химическая связь',
    'Реакции в растворах', 'Углеводороды',
    'Кислородсодержащие органические вещества', 'Азотсодержащие соединения',
  ],
  'biology': [
    'Клеточное строение', 'Генетика и наследственность',
    'Эволюция', 'Экология',
    'Фотосинтез и дыхание', 'Нервная система',
    'Размножение организмов', 'Иммунитет',
    'Биосфера', 'Молекулярная биология',
  ],
  'Биология': [
    'Клеточное строение', 'Генетика и наследственность',
    'Эволюция', 'Экология',
    'Фотосинтез и дыхание', 'Нервная система',
    'Размножение организмов', 'Иммунитет',
    'Биосфера', 'Молекулярная биология',
  ],
  'history': [
    'Петровские реформы', 'Вторая мировая война',
    'Революция 1917 года', 'Эпоха Ивана Грозного',
    'Смутное время', 'Отечественная война 1812 года',
    'СССР в 1920-30-е годы', 'Эпоха Екатерины II',
    'Россия в XIX веке', 'Постсоветская Россия',
  ],
  'История': [
    'Петровские реформы', 'Вторая мировая война',
    'Революция 1917 года', 'Эпоха Ивана Грозного',
    'Смутное время', 'Отечественная война 1812 года',
    'СССР в 1920-30-е годы', 'Эпоха Екатерины II',
    'Россия в XIX веке', 'Постсоветская Россия',
  ],
  'social': [
    'Конституция РФ', 'Рыночная экономика',
    'Права человека', 'Политические системы',
    'Правовое государство', 'Гражданское право',
    'Трудовое право', 'Социальные нормы',
    'Глобализация', 'Социальные институты',
  ],
  'Обществознание': [
    'Конституция РФ', 'Рыночная экономика',
    'Права человека', 'Политические системы',
    'Правовое государство', 'Гражданское право',
    'Трудовое право', 'Социальные нормы',
    'Глобализация', 'Социальные институты',
  ],
  'informatics': [
    'Алгоритмы сортировки', 'Рекурсия',
    'Логические операции', 'Базы данных',
    'Системы счисления', 'Программирование на Python',
    'Теория графов', 'Комбинаторика',
    'Кодирование информации', 'Сетевые технологии',
  ],
  'Информатика': [
    'Алгоритмы сортировки', 'Рекурсия',
    'Логические операции', 'Базы данных',
    'Системы счисления', 'Программирование на Python',
    'Теория графов', 'Комбинаторика',
    'Кодирование информации', 'Сетевые технологии',
  ],
  'english': [
    'Present Perfect vs Past Simple', 'Условные предложения',
    'Пассивный залог', 'Артикли',
    'Косвенная речь', 'Модальные глаголы',
    'Лексика: темы для сочинения', 'Чтение: стратегии',
    'Аудирование: типичные задания', 'Письмо: личное письмо',
  ],
  'Английский язык': [
    'Present Perfect vs Past Simple', 'Условные предложения',
    'Пассивный залог', 'Артикли',
    'Косвенная речь', 'Модальные глаголы',
    'Лексика: темы для сочинения', 'Чтение: стратегии',
    'Аудирование: типичные задания', 'Письмо: личное письмо',
  ],
  'geography': [
    'Климатические пояса', 'Природные зоны России',
    'Экономические районы', 'Демография',
    'Геология и рельеф', 'Водные ресурсы',
    'Топливно-энергетический комплекс', 'АПК России',
    'Внешняя торговля', 'Страны мира',
  ],
  'География': [
    'Климатические пояса', 'Природные зоны России',
    'Экономические районы', 'Демография',
    'Геология и рельеф', 'Водные ресурсы',
    'Топливно-энергетический комплекс', 'АПК России',
    'Внешняя торговля', 'Страны мира',
  ],
  'literature': [
    'Война и мир: образы', 'Мастер и Маргарита',
    'Лирика Пушкина', 'Преступление и наказание',
    'Горе от ума', 'Отцы и дети',
    'Чехов: рассказы', 'Лирика Лермонтова',
    'Гроза Островского', 'Мёртвые души',
  ],
  'Литература': [
    'Война и мир: образы', 'Мастер и Маргарита',
    'Лирика Пушкина', 'Преступление и наказание',
    'Горе от ума', 'Отцы и дети',
    'Чехов: рассказы', 'Лирика Лермонтова',
    'Гроза Островского', 'Мёртвые души',
  ],
};

export const DEFAULT_TOPICS = [
  { subject: 'Математика', topic: 'Квадратные уравнения' },
  { subject: 'Русский язык', topic: 'Причастие и деепричастие' },
  { subject: 'Физика', topic: 'Законы Ньютона' },
  { subject: 'Химия', topic: 'Реакции окисления-восстановления' },
  { subject: 'История', topic: 'Петровские реформы' },
  { subject: 'Обществознание', topic: 'Конституция РФ' },
];

export function simpleHash(str: string): number {
  let h = 0;
  for (let i = 0; i < str.length; i++) {
    h = (Math.imul(31, h) + str.charCodeAt(i)) | 0;
  }
  return Math.abs(h);
}

export function getTodayTopic(examSubject?: string | null): { subject: string; topic: string } {
  const today = new Date().toISOString().slice(0, 10);
  const hash = simpleHash(today);
  if (examSubject && TOPICS_BY_SUBJECT[examSubject]) {
    const topics = TOPICS_BY_SUBJECT[examSubject];
    return { subject: examSubject, topic: topics[hash % topics.length] };
  }
  const fallback = DEFAULT_TOPICS[hash % DEFAULT_TOPICS.length];
  return { subject: fallback.subject, topic: fallback.topic };
}
